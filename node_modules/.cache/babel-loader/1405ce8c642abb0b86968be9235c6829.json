{"ast":null,"code":"var _jsxFileName = \"/Users/yangcao/WebstormProjects/jarvis-web/src/GubangPage.js\";\nimport React from \"react\";\nimport \"./GubangPage.css\";\nlet listAllUrl = \"https://admin.gbhome.com/api/v4/common/3in1/discovery?pageSize=10\";\nlet listZlIdUrl = \"https://admin.gbhome.com/api/v4/common/3in1/zlContent?pageSize=10\";\nlet zlColorMap = {\n  \"独家研报\": \"tomato\",\n  \"游资锦囊\": \"slateblue\",\n  \"股帮研究院\": \"gold\"\n};\nlet token = \"Bearer eyJhbGciOiJIUzUxMiJ9.eyJ3eFVzZXJJZCI6MTA3NDk5NSwic3ViIjoiMTA3NDk5NSIsIm1vYmlsZVBob25lIjoiMTM0ODI4OTI2MTIiLCJjaGFubmVsIjoiUEMiLCJleHAiOjE1OTkzOTIwMDcsImlhdCI6MTU5NjgwMDAwN30.aLbphPZ1oz-CO9DfEFQJi1PllA0iOw58zG2rk43pP7lRXgZtZVwsyOGbm_rH6SYoHJfN-WWCQKvtENx6gLueqQ\";\n\nclass GubangPage extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"GubangPage\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 21\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 22\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 23\n      },\n      __self: this\n    }, \"\\u80A1\\u5E2E\\uFF0C\\u9884\\u671F\\u5DEE\\u5C31\\u662F\\u751F\\u4EA7\\u529B\"), React.createElement(\"div\", {\n      className: \"SubPage\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 24\n      },\n      __self: this\n    }, React.createElement(GubangInfoList, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 25\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nclass GubangInfoList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      data: [],\n      page: 1,\n      totalPages: 0,\n      needPre: false,\n      needNext: true,\n      renderDetail: false,\n      renderZlIdList: false,\n      zlId: null,\n      detailData: {},\n      filter: \"all\"\n    };\n    this.handleFilter = this.handleFilter.bind(this);\n    this.getList(this.state.page);\n  }\n\n  loadStorage(key) {\n    let storage = window.localStorage;\n\n    if (storage.hasOwnProperty(key)) {\n      return storage[key];\n    }\n\n    return null;\n  }\n\n  saveStorage(key, value) {\n    let storage = window.localStorage;\n    storage[key] = value;\n  }\n\n  async getList(pageNum) {\n    if (this.state.renderZlIdList) {\n      this.getZlIdList(pageNum, this.state.zlId);\n    } else {\n      this.getAllList(pageNum);\n    }\n  }\n\n  async getAllList(pageNum) {\n    try {\n      let response = await fetch(listAllUrl + \"&pageNum=\" + pageNum);\n      let map = await response.json();\n      this.setState({\n        data: map[\"data\"][\"records\"]\n      });\n      this.setState({\n        totalPages: map[\"pages\"]\n      });\n\n      if (pageNum === 1) {\n        let latestList = [];\n        map[\"data\"][\"records\"].forEach((v, i) => {\n          latestList.push(v[\"subjectId\"]);\n        });\n        this.saveStorage(\"latest_list\", JSON.stringify(latestList));\n      }\n    } catch (e) {\n      console.log(\"Oops, error\", e);\n    }\n  }\n\n  async compareAndRefreshAllList() {\n    try {\n      let response = await fetch(listAllUrl + \"&pageNum=1\");\n      let map = await response.json();\n      let latestListStr = this.loadStorage(\"latest_list\");\n      let latestList = JSON.parse(latestListStr);\n      let newList = [];\n      map[\"data\"][\"records\"].forEach((v, i) => {\n        newList.push(v[\"subjectId\"]);\n      });\n      console.log(\"latest: \" + latestList);\n      console.log(\"new: \" + newList);\n      latestList.forEach((v, i) => {\n        if (v !== newList[i]) {\n          return false;\n        }\n      });\n      this.setState({\n        data: map[\"data\"][\"records\"]\n      });\n      this.setState({\n        totalPages: map[\"pages\"]\n      });\n      this.saveStorage(\"latest_list\", JSON.stringify(newList));\n    } catch (e) {\n      console.log(\"Oops, error\", e);\n    }\n\n    return true;\n  }\n\n  async getZlIdList(pageNum, zlId) {\n    try {\n      let response = await fetch(listZlIdUrl + \"&pageNum=\" + pageNum + \"&zlId=\" + zlId);\n      let map = await response.json();\n      this.setState({\n        data: map[\"data\"][\"records\"]\n      });\n      this.setState({\n        totalPages: map[\"pages\"]\n      });\n    } catch (e) {\n      console.log(\"Oops, error\", e);\n    }\n  }\n\n  renderList() {\n    var listElements = [];\n    this.state.data.forEach(record => {\n      let content = record[\"content\"] === \"\" ? record[\"summary\"] : record[\"content\"];\n      listElements.push(React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, record[\"title\"], React.createElement(\"sub\", {\n        style: {\n          color: zlColorMap[record[\"zlName\"]]\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, record[\"zlName\"]), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"Snapshot\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, content, React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        style: {\n          color: \"gray\",\n          fontSize: 5\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, record[\"upTime\"], React.createElement(\"button\", {\n        className: \"NaviDetailBtn\",\n        onClick: () => this.clickDetail(record[\"type\"], record[\"subjectId\"]),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, \"\\u8BE6\\u60C5\")), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }))));\n    });\n    return listElements;\n  }\n\n  async clickDetail(type, id) {\n    try {\n      let response = await fetch(\"https://admin.gbhome.com/api/common/\" + type + \"/detail/\" + id, {\n        headers: {\n          \"authorization\": token\n        }\n      });\n      let map = await response.json();\n      this.setState({\n        detailData: map[\"data\"],\n        renderDetail: true\n      });\n    } catch (e) {\n      console.log(\"Oops, error\", e);\n    }\n  }\n\n  backToList() {\n    this.setState({\n      renderDetail: false\n    });\n  }\n\n  renderDetail() {\n    let details = [];\n    details.push(React.createElement(\"button\", {\n      className: \"BackButton\",\n      onClick: () => this.backToList(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, \"<\", \"\\u8FD4\\u56DE\"));\n\n    if (this.state.detailData.hasOwnProperty(\"zlArticle\")) {\n      details.push(React.createElement(\"div\", {\n        dangerouslySetInnerHTML: {\n          __html: this.state.detailData[\"zlArticle\"][\"detail\"]\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }));\n    } else if (this.state.detailData.hasOwnProperty(\"zlTrendsDto\")) {\n      details.push(React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, this.state.detailData[\"zlTrendsDto\"][\"content\"]));\n\n      if (this.state.detailData[\"zlTrendsDto\"][\"trendsImgList\"] !== null) {\n        this.state.detailData[\"zlTrendsDto\"][\"trendsImgList\"].forEach((item, index) => {\n          details.push(React.createElement(\"img\", {\n            src: item[\"imgSrc\"],\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 178\n            },\n            __self: this\n          }));\n        });\n      }\n    } else if (this.state.detailData.hasOwnProperty(\"zlQuestion\")) {\n      details.push(React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, this.state.detailData[\"zlQuestion\"][\"detail\"]), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, this.state.detailData[\"zlAnswersDtoPage\"][\"records\"][0][\"content\"])));\n    }\n\n    details.push(React.createElement(\"button\", {\n      className: \"BackButton\",\n      onClick: () => this.backToList(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, \"<\", \"\\u8FD4\\u56DE\"));\n    return details;\n  }\n\n  nextPage() {\n    let curPage = this.state.page + 1;\n    this.setState({\n      page: curPage\n    });\n    this.getList(curPage);\n    this.refreshPageChanger(curPage);\n  }\n\n  prePage() {\n    let curPage = this.state.page - 1;\n    this.setState({\n      page: curPage\n    });\n    this.getList(curPage);\n    this.refreshPageChanger(curPage);\n  }\n\n  refreshPageChanger(curPage) {\n    if (curPage === 1) {\n      this.setState({\n        needPre: false\n      });\n    } else {\n      this.setState({\n        needPre: true\n      });\n    }\n  }\n\n  renderPageChanger() {\n    let result = [];\n\n    if (this.state.needPre) {\n      result.push(React.createElement(\"button\", {\n        className: \"PageButton\",\n        onClick: () => this.prePage(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }, \"\\u4E0A\\u4E00\\u9875\"));\n    }\n\n    if (this.state.needNext) {\n      result.push(React.createElement(\"button\", {\n        className: \"PageButton\",\n        onClick: () => this.nextPage(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225\n        },\n        __self: this\n      }, \"\\u4E0B\\u4E00\\u9875\"));\n    }\n\n    return result;\n  }\n\n  handleFilter(e) {\n    this.setState({\n      page: 1\n    });\n\n    if (e.target.value === \"全部\") {\n      this.setState({\n        renderZlIdList: false\n      });\n      this.getAllList(1);\n    } else {\n      this.setState({\n        renderZlIdList: true,\n        zlId: e.target.value\n      });\n      this.getZlIdList(1, e.target.value);\n    }\n  }\n\n  render() {\n    if (this.state.renderDetail) {\n      return React.createElement(\"div\", {\n        className: \"PageDetail\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251\n        },\n        __self: this\n      }, this.renderDetail());\n    }\n\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"BackButton\",\n      onClick: () => this.getList(this.state.page),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258\n      },\n      __self: this\n    }, \"\\u5237\\u65B0\"), React.createElement(\"select\", {\n      onChange: this.handleFilter,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      value: \"\\u5168\\u90E8\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260\n      },\n      __self: this\n    }, \"\\u5168\\u90E8\"), React.createElement(\"option\", {\n      value: \"1000003\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261\n      },\n      __self: this\n    }, \"\\u72EC\\u5BB6\\u7814\\u62A5\"), React.createElement(\"option\", {\n      value: \"1000004\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262\n      },\n      __self: this\n    }, \"\\u6E38\\u8D44\\u9526\\u56CA\")), this.renderList(), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265\n      },\n      __self: this\n    }, \"[\\u7B2C\", this.state.page, \"\\u9875] \", this.renderPageChanger()));\n  }\n\n  componentDidMount() {\n    this.timer = setInterval(() => {\n      // 轮询\n      let noDiff = this.compareAndRefreshAllList();\n\n      if (!noDiff) {\n        console.log(\"capture diff!\");\n        Notification.requestPermission(); // 获取通知权限\n\n        if (Notification.permission === \"granted\") {\n          // denied (用户拒绝了通知的显示), granted (用户允许了通知的显示),\n          let notice = new Notification(\"Jarvis Notice\", {\n            body: \"股帮更新啦~\",\n            silent: true,\n            //通知是否静音，默认false，表示无声\n            renotify: false,\n            //新通知是否覆盖旧的通知，默认为true，表示永远只显示一条通知；false不覆盖会多条通知叠加\n            requireInteraction: true,\n            // 不自动关闭通知知道用户点击或关闭，默认false\n            sticky: true //一个 Boolean 指明通知是否应该是“粘”, 即不易被用户清理。默认值为false，这意味着它不会粘。\n\n          });\n\n          notice.onshow = function () {// do something\n          };\n\n          notice.onclick = function () {\n            window.focus(); //这里是可以让浏览器到页面最顶层,并且浏览器显示消息页面tab(前提是当前页面没有关闭)\n\n            notice.close();\n          };\n\n          notice.onerror = function (err) {// do something\n          };\n\n          notice.onclose = function () {// do something\n          };\n        } else if (Notification.permission === \"denied\") {\n          clearInterval(this.timer);\n        }\n      }\n    }, 30000 + Math.floor(Math.random() * 10000));\n  }\n\n  componentWillUnmount() {\n    if (this.timer !== null) {\n      clearInterval(this.timer);\n    }\n  }\n\n}\n\nexport default GubangPage;","map":{"version":3,"sources":["/Users/yangcao/WebstormProjects/jarvis-web/src/GubangPage.js"],"names":["React","listAllUrl","listZlIdUrl","zlColorMap","token","GubangPage","Component","constructor","props","render","GubangInfoList","state","data","page","totalPages","needPre","needNext","renderDetail","renderZlIdList","zlId","detailData","filter","handleFilter","bind","getList","loadStorage","key","storage","window","localStorage","hasOwnProperty","saveStorage","value","pageNum","getZlIdList","getAllList","response","fetch","map","json","setState","latestList","forEach","v","i","push","JSON","stringify","e","console","log","compareAndRefreshAllList","latestListStr","parse","newList","renderList","listElements","record","content","color","fontSize","clickDetail","type","id","headers","backToList","details","__html","item","index","nextPage","curPage","refreshPageChanger","prePage","renderPageChanger","result","target","componentDidMount","timer","setInterval","noDiff","Notification","requestPermission","permission","notice","body","silent","renotify","requireInteraction","sticky","onshow","onclick","focus","close","onerror","err","onclose","clearInterval","Math","floor","random","componentWillUnmount"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport \"./GubangPage.css\"\n\nlet listAllUrl = \"https://admin.gbhome.com/api/v4/common/3in1/discovery?pageSize=10\";\nlet listZlIdUrl = \"https://admin.gbhome.com/api/v4/common/3in1/zlContent?pageSize=10\";\nlet zlColorMap = {\n    \"独家研报\": \"tomato\",\n    \"游资锦囊\": \"slateblue\",\n    \"股帮研究院\": \"gold\"\n};\nlet token = \"Bearer eyJhbGciOiJIUzUxMiJ9.eyJ3eFVzZXJJZCI6MTA3NDk5NSwic3ViIjoiMTA3NDk5NSIsIm1vYmlsZVBob25lIjoiMTM0ODI4OTI2MTIiLCJjaGFubmVsIjoiUEMiLCJleHAiOjE1OTkzOTIwMDcsImlhdCI6MTU5NjgwMDAwN30.aLbphPZ1oz-CO9DfEFQJi1PllA0iOw58zG2rk43pP7lRXgZtZVwsyOGbm_rH6SYoHJfN-WWCQKvtENx6gLueqQ\";\n\nclass GubangPage extends React.Component {\n\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        return (\n            <div className='GubangPage'>\n                <span>\n                    <h2>股帮，预期差就是生产力</h2>\n                    <div className=\"SubPage\">\n                        <GubangInfoList />\n                    </div>\n                </span>\n            </div>\n        )\n    }\n}\n\nclass GubangInfoList extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            data: [],\n            page: 1,\n            totalPages: 0,\n            needPre: false,\n            needNext: true,\n            renderDetail: false,\n            renderZlIdList: false,\n            zlId: null,\n            detailData: {},\n            filter: \"all\"\n        };\n        this.handleFilter = this.handleFilter.bind(this);\n        this.getList(this.state.page)\n    }\n\n    loadStorage(key) {\n        let storage=window.localStorage;\n        if (storage.hasOwnProperty(key)) {\n            return storage[key]\n        }\n        return null;\n    }\n\n    saveStorage(key, value) {\n        let storage=window.localStorage;\n        storage[key] = value\n    }\n\n    async getList(pageNum) {\n        if (this.state.renderZlIdList) {\n            this.getZlIdList(pageNum, this.state.zlId)\n        } else {\n            this.getAllList(pageNum)\n        }\n    }\n\n    async getAllList(pageNum) {\n        try {\n            let response = await fetch(listAllUrl+\"&pageNum=\"+pageNum);\n            let map = await response.json();\n            this.setState({data: map[\"data\"][\"records\"]});\n            this.setState({totalPages: map[\"pages\"]});\n            if (pageNum === 1) {\n                let latestList = [];\n                map[\"data\"][\"records\"].forEach((v, i) => {\n                   latestList.push(v[\"subjectId\"])\n                });\n                this.saveStorage(\"latest_list\", JSON.stringify(latestList))\n            }\n        } catch(e) {\n            console.log(\"Oops, error\", e);\n        }\n    }\n\n    async compareAndRefreshAllList() {\n        try {\n            let response = await fetch(listAllUrl+\"&pageNum=1\");\n            let map = await response.json();\n            let latestListStr = this.loadStorage(\"latest_list\");\n            let latestList = JSON.parse(latestListStr);\n            let newList = [];\n            map[\"data\"][\"records\"].forEach((v, i) => {\n                newList.push(v[\"subjectId\"])\n            });\n            console.log(\"latest: \" + latestList);\n            console.log(\"new: \" + newList);\n            latestList.forEach((v, i) => {\n                if (v !== newList[i]) {\n                    return false;\n                }\n            });\n            this.setState({data: map[\"data\"][\"records\"]});\n            this.setState({totalPages: map[\"pages\"]});\n            this.saveStorage(\"latest_list\", JSON.stringify(newList))\n        } catch(e) {\n            console.log(\"Oops, error\", e);\n        }\n        return true;\n    }\n\n    async getZlIdList(pageNum, zlId) {\n        try {\n            let response = await fetch(listZlIdUrl+\"&pageNum=\"+pageNum+\"&zlId=\"+zlId);\n            let map = await response.json();\n            this.setState({data: map[\"data\"][\"records\"]});\n            this.setState({totalPages: map[\"pages\"]})\n        } catch(e) {\n            console.log(\"Oops, error\", e);\n        }\n    }\n\n    renderList() {\n        var listElements=[];\n        this.state.data.forEach((record)=>{\n            let content = record[\"content\"] === \"\" ? record[\"summary\"]: record[\"content\"];\n            listElements.push(\n                <p>\n                    {record[\"title\"]}<sub style={{color: zlColorMap[record[\"zlName\"]]}}>{record[\"zlName\"]}</sub><br/>\n                    <div className='Snapshot'>\n                        {content}<br/>\n                        <div style={{color:\"gray\", fontSize: 5}}>\n                            {record[\"upTime\"]}\n                            <button className=\"NaviDetailBtn\" onClick={() => this.clickDetail(record[\"type\"], record[\"subjectId\"])}>详情</button>\n                        </div>\n                        <br/>\n                    </div>\n                </p>\n            )\n        });\n        return listElements;\n    }\n\n    async clickDetail(type, id) {\n        try {\n            let response = await fetch(\"https://admin.gbhome.com/api/common/\" + type + \"/detail/\" + id, {headers:{\"authorization\":token}});\n            let map = await response.json();\n            this.setState({\n                detailData: map[\"data\"],\n                renderDetail: true\n            })\n        } catch(e) {\n            console.log(\"Oops, error\", e);\n        }\n    }\n\n    backToList() {\n        this.setState({\n            renderDetail: false\n        })\n    }\n\n    renderDetail() {\n        let details = [];\n        details.push(<button className=\"BackButton\" onClick={() => this.backToList()}>{\"<\"}返回</button>);\n        if (this.state.detailData.hasOwnProperty(\"zlArticle\")) {\n            details.push(<div dangerouslySetInnerHTML={{__html: this.state.detailData[\"zlArticle\"][\"detail\"]}}/>);\n        } else if (this.state.detailData.hasOwnProperty(\"zlTrendsDto\")) {\n            details.push(<div>{this.state.detailData[\"zlTrendsDto\"][\"content\"]}</div>)\n            if (this.state.detailData[\"zlTrendsDto\"][\"trendsImgList\"] !== null) {\n                this.state.detailData[\"zlTrendsDto\"][\"trendsImgList\"].forEach((item, index) => {\n                    details.push(<img src={item[\"imgSrc\"]}></img>)\n                });\n            }\n        } else if (this.state.detailData.hasOwnProperty(\"zlQuestion\")) {\n            details.push(<div>\n                <h2>{this.state.detailData[\"zlQuestion\"][\"detail\"]}</h2>\n                <p>{this.state.detailData[\"zlAnswersDtoPage\"][\"records\"][0][\"content\"]}</p>\n            </div>)\n        }\n        details.push(<button className=\"BackButton\" onClick={() => this.backToList()}>{\"<\"}返回</button>);\n        return (\n            details\n        )\n    }\n\n    nextPage() {\n        let curPage = this.state.page + 1;\n        this.setState({\n            page: curPage\n        });\n        this.getList(curPage);\n        this.refreshPageChanger(curPage)\n    }\n\n    prePage() {\n        let curPage = this.state.page - 1;\n        this.setState({\n            page: curPage\n        });\n        this.getList(curPage);\n        this.refreshPageChanger(curPage)\n    }\n\n    refreshPageChanger(curPage) {\n        if (curPage === 1) {\n            this.setState({needPre: false})\n        } else {\n            this.setState({needPre: true})\n        }\n    }\n\n    renderPageChanger() {\n        let result = [];\n        if (this.state.needPre) {\n            result.push(<button className=\"PageButton\" onClick={() => this.prePage()}>上一页</button>)\n        }\n        if (this.state.needNext) {\n            result.push(<button className=\"PageButton\" onClick={() => this.nextPage()}>下一页</button>)\n        }\n        return result\n    }\n\n    handleFilter(e) {\n        this.setState({\n            page: 1\n        });\n        if (e.target.value === \"全部\") {\n            this.setState({\n                    renderZlIdList: false\n            });\n            this.getAllList(1)\n        } else {\n            this.setState({\n                renderZlIdList: true,\n                zlId: e.target.value\n            });\n            this.getZlIdList(1, e.target.value)\n        }\n    }\n\n    render() {\n        if (this.state.renderDetail) {\n            return (\n                <div className=\"PageDetail\">\n                    {this.renderDetail()}\n                </div>\n            )\n        }\n        return (\n            <div>\n                <button className=\"BackButton\" onClick={() => this.getList(this.state.page)}>刷新</button>\n                <select onChange={this.handleFilter}>\n                    <option value=\"全部\">全部</option>\n                    <option value=\"1000003\">独家研报</option>\n                    <option value=\"1000004\">游资锦囊</option>\n                </select>\n                {this.renderList()}\n                <div>\n                    [第{this.state.page}页] {this.renderPageChanger()}\n                </div>\n            </div>\n        );\n    }\n\n    componentDidMount(){\n        this.timer=setInterval(()=>{ // 轮询\n            let noDiff = this.compareAndRefreshAllList();\n            if (!noDiff) {\n                console.log(\"capture diff!\");\n                Notification.requestPermission();// 获取通知权限\n                if (Notification.permission === \"granted\") {// denied (用户拒绝了通知的显示), granted (用户允许了通知的显示),\n                    let notice = new Notification(\"Jarvis Notice\", {\n                        body : \"股帮更新啦~\",\n                        silent:true,//通知是否静音，默认false，表示无声\n                        renotify:false,//新通知是否覆盖旧的通知，默认为true，表示永远只显示一条通知；false不覆盖会多条通知叠加\n                        requireInteraction: true, // 不自动关闭通知知道用户点击或关闭，默认false\n                        sticky: true,//一个 Boolean 指明通知是否应该是“粘”, 即不易被用户清理。默认值为false，这意味着它不会粘。\n                    });\n                    notice.onshow = function () {\n                        // do something\n                    };\n                    notice.onclick = function () {\n                        window.focus();//这里是可以让浏览器到页面最顶层,并且浏览器显示消息页面tab(前提是当前页面没有关闭)\n                        notice.close();\n                    };\n                    notice.onerror = function (err) {\n                        // do something\n                    };\n                    notice.onclose = function () {\n                        // do something\n                    }\n                }else if(Notification.permission === \"denied\"){\n                    clearInterval(this.timer);\n                }\n            }\n        },30000 + Math.floor(Math.random()*10000))\n    }\n    componentWillUnmount(){\n        if(this.timer !== null) {\n            clearInterval(this.timer);\n        }\n    }\n}\n\nexport default GubangPage;"]},"metadata":{},"sourceType":"module"}