{"ast":null,"code":"var _jsxFileName = \"/Users/yangcao/WebstormProjects/jarvis-web/src/QuantificationPage.js\";\nimport React from \"react\";\nimport \"./QuantificationPage.css\";\nimport Datetime from 'react-datetime';\nimport \"react-datetime/css/react-datetime.css\";\nimport moment from 'moment';\nimport 'moment/locale/zh-cn';\nlet host = \"http://127.0.0.1:8000\"; // let host = \"http://118.25.41.14:8091\";\n\nclass QuantificationPage extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"QuantificationPage\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 19\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 20\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 21\n      },\n      __self: this\n    }, \"\\u91CF\\u5316\\u5C0F\\u5E73\\u53F0\"), React.createElement(SelectorTool, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 22\n      },\n      __self: this\n    })));\n  }\n\n}\n\nclass SelectorTool extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      ts: new Date().getTime(),\n      selector_list: [],\n      current_selector: \"\",\n      launched: false,\n      launched_id: 0\n    };\n    this.dateOnChange = this.dateOnChange.bind(this);\n    this.getSelectors = this.getSelectors.bind(this);\n    this.changeSelector = this.changeSelector.bind(this);\n    this.launchSelectors = this.launchSelectors.bind(this);\n    this.getSelectors();\n  }\n\n  dateOnChange(e) {\n    this.setState({\n      ts: e.valueOf() / 1000\n    });\n  }\n\n  async getSelectors() {\n    try {\n      let uri = \"/selector/get_selectors\";\n      let response = await fetch(host + uri);\n      let map = await response.json();\n      this.setState({\n        selector_list: map['result']\n      });\n    } catch (e) {\n      console.log(\"Oops, error\", e);\n    }\n  }\n\n  async launchSelectors() {\n    try {\n      let uri = \"/selector/launch\";\n      let response = await fetch(host + uri, {\n        method: 'POST',\n        body: JSON.stringify({\n          \"name\": this.state.current_selector,\n          \"ts\": this.state.ts\n        })\n      });\n      let map = await response.json();\n      this.setState({\n        launch_id: map['result']\n      });\n    } catch (e) {\n      console.log(\"Oops, error\", e);\n    }\n  }\n\n  changeSelector(e) {\n    this.setState({\n      current_selector: e.target.value\n    });\n  }\n\n  renderResult() {\n    if (this.state.launched) {\n      return \"正在运行中，请稍等...\";\n    } else {\n      return \"尚未运行\";\n    }\n  }\n\n  componentDidMount() {\n    this.timer = setInterval(() => {\n      // 轮询\n      console.log(\"轮询\");\n    }, 1000);\n  }\n\n  componentWillUnmount() {\n    if (this.timer !== null) {\n      clearInterval(this.timer);\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"SelectorTool\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, \"\\u9009\\u80A1\\u5C0F\\u5DE5\\u5177\"), \"\\u65F6\\u95F4: \", React.createElement(Datetime, {\n      locale: \"zh-cn\",\n      onChange: this.dateOnChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }), \"\\u9009\\u80A1\\u7B56\\u7565:\", React.createElement(\"select\", {\n      onChange: this.changeSelector,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, React.createElement(\"option\", {\n      value: \"未选择\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, \"\\u672A\\u9009\\u62E9\"), this.state.selector_list.map(selector => {\n      return React.createElement(\"option\", {\n        value: selector,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, selector);\n    })), React.createElement(\"button\", {\n      name: \"launch\",\n      onClick: this.launchSelectors,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, \"\\u8FD0\\u884C\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }), \"\\u7ED3\\u679C:\", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }), this.renderResult()));\n  }\n\n}\n\nexport default QuantificationPage;","map":{"version":3,"sources":["/Users/yangcao/WebstormProjects/jarvis-web/src/QuantificationPage.js"],"names":["React","Datetime","moment","host","QuantificationPage","Component","constructor","props","render","SelectorTool","state","ts","Date","getTime","selector_list","current_selector","launched","launched_id","dateOnChange","bind","getSelectors","changeSelector","launchSelectors","e","setState","valueOf","uri","response","fetch","map","json","console","log","method","body","JSON","stringify","launch_id","target","value","renderResult","componentDidMount","timer","setInterval","componentWillUnmount","clearInterval","selector"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport \"./QuantificationPage.css\"\nimport Datetime from 'react-datetime';\nimport \"react-datetime/css/react-datetime.css\";\nimport moment from 'moment';\nimport 'moment/locale/zh-cn';\n\nlet host = \"http://127.0.0.1:8000\";\n// let host = \"http://118.25.41.14:8091\";\n\nclass QuantificationPage extends React.Component {\n\n    constructor(props) {\n        super(props);\n    }\n\n    render() {\n        return (\n            <div className='QuantificationPage'>\n                <span>\n                    <h2>量化小平台</h2>\n                    <SelectorTool />\n                </span>\n            </div>\n        )\n    }\n}\n\nclass SelectorTool extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            ts: new Date().getTime(),\n            selector_list: [],\n            current_selector: \"\",\n            launched: false,\n            launched_id: 0\n        };\n        this.dateOnChange = this.dateOnChange.bind(this);\n        this.getSelectors = this.getSelectors.bind(this);\n        this.changeSelector = this.changeSelector.bind(this);\n        this.launchSelectors = this.launchSelectors.bind(this);\n        this.getSelectors()\n    }\n\n    dateOnChange(e) {\n        this.setState({\n            ts: e.valueOf()/1000\n        });\n    }\n\n    async getSelectors() {\n        try {\n            let uri = \"/selector/get_selectors\";\n            let response = await fetch(host+uri);\n            let map = await response.json();\n            this.setState({\n                selector_list: map['result']\n            })\n        } catch(e) {\n            console.log(\"Oops, error\", e);\n        }\n    }\n\n    async launchSelectors() {\n        try {\n            let uri = \"/selector/launch\";\n            let response = await fetch(host+uri, {\n                method: 'POST',\n                body: JSON.stringify({\n                    \"name\": this.state.current_selector,\n                    \"ts\": this.state.ts,\n                })\n            });\n            let map = await response.json();\n            this.setState({\n                launch_id: map['result']\n            })\n\n        } catch (e) {\n            console.log(\"Oops, error\", e);\n        }\n    }\n\n    changeSelector(e) {\n        this.setState({\n            current_selector: e.target.value\n        })\n    }\n\n    renderResult() {\n        if (this.state.launched) {\n            return \"正在运行中，请稍等...\"\n        } else {\n            return \"尚未运行\"\n        }\n    }\n\n    componentDidMount(){\n        this.timer=setInterval(()=>{ // 轮询\n            console.log(\"轮询\")\n        },1000)\n    }\n\n    componentWillUnmount(){\n        if(this.timer !== null) {\n            clearInterval(this.timer);\n        }\n    }\n\n    render() {\n        return (\n            <div className='SelectorTool'>\n                <span>\n                    <h3>选股小工具</h3>\n                    时间: <Datetime locale=\"zh-cn\" onChange={this.dateOnChange}/>\n                    <br/>\n                    选股策略:\n                    <select onChange={this.changeSelector}>\n                        <option value={\"未选择\"}>未选择</option>\n                        {\n                            this.state.selector_list.map(selector => {\n                                return <option value={selector}>{selector}</option>\n                            })\n                        }\n                    </select>\n                    <button name={\"launch\"} onClick={this.launchSelectors}>运行</button>\n                    <br/>\n                    <br/>\n                    结果:\n                    <br/>\n                    {this.renderResult()}\n                </span>\n            </div>\n        )\n    }\n}\n\nexport default QuantificationPage;"]},"metadata":{},"sourceType":"module"}