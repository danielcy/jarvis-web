{"ast":null,"code":"var _jsxFileName = \"/Users/yangcao/WebstormProjects/jarvis-web/src/ConfirmationPage.js\";\nimport React from 'react';\nimport \"./ConfirmationPage.css\"; // let host = \"http://127.0.0.1:8000\";\n\nlet host = \"http://118.25.41.14:8091\";\n\nclass ConfirmationPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      confirmationTemplateFile: null,\n      inputTemplateFile: null,\n      result: \"x\"\n    };\n    this.uploadConfirmationTemplate = this.uploadConfirmationTemplate.bind(this);\n    this.uploadInputTemplate = this.uploadInputTemplate.bind(this);\n    this.toBase64 = this.toBase64.bind(this);\n  }\n\n  uploadConfirmationTemplate(e) {\n    let reader = new FileReader();\n    let file = e.target.files[0];\n    reader.parent = this;\n\n    reader.onload = function (e) {\n      this.parent.httpUpload(this.result.split(',')[1], \"/upload_confirmation_template\");\n    };\n\n    reader.readAsDataURL(file);\n    this.setState({\n      confirmationTemplateFile: file\n    });\n  }\n\n  uploadInputTemplate(e) {\n    let reader = new FileReader();\n    let file = e.target.files[0];\n    reader.parent = this;\n\n    reader.onload = function (e) {\n      this.parent.httpUpload(this.result.split(',')[1], \"/upload_input_template\");\n    };\n\n    reader.readAsDataURL(file);\n    this.setState({\n      inputTemplateFile: file\n    });\n  }\n\n  executeMerge() {\n    // this.httpExecute(\"/execute_confirmation_merge\")\n    console.log(\"x\");\n  }\n\n  httpUpload(d, uri) {\n    var data = JSON.stringify({\n      \"data\": d\n    });\n    var xhr = new XMLHttpRequest();\n    xhr.withCredentials = true;\n    xhr.addEventListener(\"readystatechange\", function () {\n      if (this.readyState === 4) {\n        alert(\"上传成功！\");\n      }\n    });\n    console.log(host + uri);\n    xhr.open(\"POST\", host + uri);\n    xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n    xhr.send(data);\n  }\n\n  httpExecute(uri) {\n    let xhr = new XMLHttpRequest();\n    xhr.withCredentials = true;\n    xhr.open(\"GET\", host + uri);\n    xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n    xhr.responseType = \"blob\";\n\n    xhr.onload = function (oEvent) {\n      let content = xhr.response;\n      let elink = document.createElement('a');\n      elink.download = \"输出结果.xls\";\n      elink.style.display = 'none';\n      let blob = new Blob([content]);\n      elink.href = URL.createObjectURL(blob);\n      document.body.appendChild(elink);\n      elink.click();\n      document.body.removeChild(elink);\n    };\n\n    xhr.send();\n  }\n\n  toBase64(e) {\n    let reader = new FileReader();\n    let base64 = '';\n\n    reader.onload = function (e) {\n      base64 = this.result;\n    };\n\n    reader.readAsDataURL(e);\n    console.log(base64);\n    this.setState({\n      result: base64\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"ConfirmationPage\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, \"Happy Confirmation Maker\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, \"\\u4E0A\\u4F20\\u51FD\\u8BC1\\u6A21\\u677F\", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }), React.createElement(UploadButton, {\n      accept: \"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\n      onChange: this.uploadConfirmationTemplate,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      className: \"UploadResult\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, this.state.confirmationTemplateFile == null ? '未上传' : this.state.confirmationTemplateFile.name)), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, \"\\u4E0A\\u4F20\\u8F93\\u5165\\u6A21\\u677F\", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }), React.createElement(UploadButton, {\n      accept: \"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\n      onChange: this.uploadInputTemplate,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      className: \"UploadResult\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, this.state.inputTemplateFile == null ? '未上传' : this.state.inputTemplateFile.name)), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, React.createElement(ExecuteButton, {\n      onClick: this.executeMerge(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    })), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }));\n  }\n\n}\n\nclass UploadButton extends React.Component {\n  constructor(props) {\n    super(props);\n    this.getFiles = this.getFiles.bind(this);\n    this.onChange = this.onChange.bind(this);\n  }\n\n  getFiles() {\n    let ans = [];\n    let files = this.refs.fileLoader.files;\n\n    for (let i = 0; i < files.length; i++) {\n      ans.push(files[i]);\n    }\n\n    return ans;\n  }\n\n  onChange() {\n    console.log(this.getFiles());\n  }\n\n  render() {\n    let accept = this.props.accept;\n    return React.createElement(\"label\", {\n      className: \"UploadButton\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, \"\\u70B9\\u51FB\\u8FD9\\u91CC\\u4E0A\\u4F20\\u6587\\u4EF6\", React.createElement(\"input\", {\n      ref: \"fileLoader\",\n      onChange: this.props.onChange,\n      type: \"file\",\n      accept: accept,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }));\n  }\n\n}\n\nclass ExecuteButton extends React.Component {\n  render() {\n    return React.createElement(\"label\", {\n      className: \"ExecuteButton\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: this.props.onClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, \"GoGoGo!\"));\n  }\n\n}\n\nexport default ConfirmationPage;","map":{"version":3,"sources":["/Users/yangcao/WebstormProjects/jarvis-web/src/ConfirmationPage.js"],"names":["React","host","ConfirmationPage","Component","constructor","props","state","confirmationTemplateFile","inputTemplateFile","result","uploadConfirmationTemplate","bind","uploadInputTemplate","toBase64","e","reader","FileReader","file","target","files","parent","onload","httpUpload","split","readAsDataURL","setState","executeMerge","console","log","d","uri","data","JSON","stringify","xhr","XMLHttpRequest","withCredentials","addEventListener","readyState","alert","open","setRequestHeader","send","httpExecute","responseType","oEvent","content","response","elink","document","createElement","download","style","display","blob","Blob","href","URL","createObjectURL","body","appendChild","click","removeChild","base64","render","name","UploadButton","getFiles","onChange","ans","refs","fileLoader","i","length","push","accept","ExecuteButton","onClick"],"mappings":"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","sourcesContent":["import React from 'react';\nimport \"./ConfirmationPage.css\"\n\n// let host = \"http://127.0.0.1:8000\";\nlet host = \"http://118.25.41.14:8091\";\n\nclass ConfirmationPage extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            confirmationTemplateFile: null,\n            inputTemplateFile: null,\n            result: \"x\",\n        };\n\n        this.uploadConfirmationTemplate = this.uploadConfirmationTemplate.bind(this);\n        this.uploadInputTemplate = this.uploadInputTemplate.bind(this);\n        this.toBase64 = this.toBase64.bind(this);\n    }\n\n    uploadConfirmationTemplate(e) {\n        let reader = new FileReader();\n        let file = e.target.files[0];\n        reader.parent = this;\n        reader.onload = function(e) {\n            this.parent.httpUpload(this.result.split(',')[1], \"/upload_confirmation_template\");\n        };\n        reader.readAsDataURL(file);\n        this.setState({\n            confirmationTemplateFile: file,\n        });\n    }\n\n    uploadInputTemplate(e) {\n        let reader = new FileReader();\n        let file = e.target.files[0];\n        reader.parent = this;\n        reader.onload = function(e) {\n            this.parent.httpUpload(this.result.split(',')[1], \"/upload_input_template\");\n        };\n        reader.readAsDataURL(file);\n        this.setState({\n            inputTemplateFile: file,\n        });\n    }\n\n    executeMerge() {\n        // this.httpExecute(\"/execute_confirmation_merge\")\n        console.log(\"x\")\n    }\n\n    httpUpload(d, uri) {\n        var data = JSON.stringify({\"data\":d});\n        var xhr = new XMLHttpRequest();\n        xhr.withCredentials = true;\n        xhr.addEventListener(\"readystatechange\", function() {\n            if(this.readyState === 4) {\n                alert(\"上传成功！\");\n            }\n        });\n\n        console.log(host+uri);\n        xhr.open(\"POST\", host + uri);\n        xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n\n        xhr.send(data);\n    }\n\n    httpExecute(uri) {\n        let xhr = new XMLHttpRequest();\n        xhr.withCredentials = true;\n        xhr.open(\"GET\", host + uri);\n        xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n\n        xhr.responseType = \"blob\";\n        xhr.onload = function (oEvent) {\n            let content = xhr.response;\n            let elink = document.createElement('a');\n            elink.download = \"输出结果.xls\";\n            elink.style.display = 'none';\n            let blob = new Blob([content]);\n            elink.href = URL.createObjectURL(blob);\n            document.body.appendChild(elink);\n            elink.click();\n            document.body.removeChild(elink);\n        };\n\n        xhr.send();\n    }\n\n    toBase64(e) {\n        let reader = new FileReader();\n        let base64 = '';\n        reader.onload = function(e) {\n            base64 = this.result\n        };\n        reader.readAsDataURL(e);\n        console.log(base64);\n        this.setState({\n            result: base64\n        })\n    }\n\n    render() {\n        return (\n            <div className='ConfirmationPage'>\n                <h2>Happy Confirmation Maker</h2>\n                <br/>\n                <p>\n                    上传函证模板\n                    <br/><br/>\n                    {/*TODO: confirmation template upload*/}\n                    <UploadButton\n                        accept = {\"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"}\n                        onChange = {this.uploadConfirmationTemplate}\n                    />\n                    <br/>\n                    <label className='UploadResult'>\n                        {this.state.confirmationTemplateFile == null ? '未上传': this.state.confirmationTemplateFile.name}\n                    </label>\n                </p>\n                <p>\n                    上传输入模板\n                    <br/><br/>\n                    {/*TODO: confirmation template upload*/}\n                    <UploadButton\n                        accept = {\"application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"}\n                        onChange = {this.uploadInputTemplate}\n                    />\n                    <br/>\n                    <label className='UploadResult'>\n                        {this.state.inputTemplateFile == null ? '未上传': this.state.inputTemplateFile.name}\n                    </label>\n                </p>\n                <p>\n                    <ExecuteButton\n                        onClick = {this.executeMerge()}\n                    />\n                </p>\n                <br/><br/><br/><br/>\n\n            </div>\n        )\n    }\n}\n\nclass UploadButton extends React.Component {\n    constructor(props) {\n        super(props);\n        this.getFiles = this.getFiles.bind(this);\n        this.onChange = this.onChange.bind(this)\n    }\n\n    getFiles() {\n        let ans = [];\n        let files = this.refs.fileLoader.files;\n        for (let i = 0; i < files.length; i++) {\n            ans.push(files[i])\n        }\n        return ans\n    }\n\n    onChange() {\n        console.log(this.getFiles())\n    }\n\n    render() {\n        let accept = this.props.accept;\n        return (\n            <label className=\"UploadButton\">\n                点击这里上传文件\n                <input ref='fileLoader' onChange={this.props.onChange} type=\"file\" accept={accept} />\n            </label>\n        );\n    }\n}\n\nclass ExecuteButton extends React.Component {\n    render() {\n        return (\n            <label className='ExecuteButton'>\n                <button\n                    onClick ={this.props.onClick}\n                >GoGoGo!</button>\n            </label>\n        )\n    }\n}\n\nexport default ConfirmationPage;\n\n\n"]},"metadata":{},"sourceType":"module"}